<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Malinoise - Tu asistente de negocios inteligente con IA para an√°lisis predictivo, gesti√≥n de inventario y automatizaci√≥n empresarial.">
    <meta name="keywords" content="IA, negocios, an√°lisis predictivo, gesti√≥n empresarial, automatizaci√≥n">
    <meta name="author" content="Malinoise Team">
    
    <title>Malinoise - Tu Asistente de Negocios Inteligente</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style">
    
    <!-- CDN Libraries - Optimized loading -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js" defer></script>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">    
    <!-- 
    ============================================================================
    DISE√ëO Y ARQUITECTURA DEL PROYECTO MALINOISE
    ============================================================================
    
    PALETA DE COLORES:
    - Fondo principal: bg-slate-50 (#F8FAFC)
    - Texto: text-slate-800 (#1E293B), text-slate-600 (#475569)
    - Acento principal: bg-teal-600 (#0D9488)
    - Acento secundario: bg-slate-200 (#E2E8F0)
    - Resaltados: Teal, Amber
    
    ARQUITECTURA SPA:
    1. Navegaci√≥n sticky con scroll activo
    2. Secci√≥n Hero - Propuesta de valor principal
    3. M√≥dulos interactivos - 6 tarjetas expandibles
    4. Demo IA - Gr√°fico interactivo con Chart.js
    5. Stack tecnol√≥gico - Diagrama visual
    6. Modelo de negocio - Comparaci√≥n Freemium vs Premium
    7. Descargas - Plataformas con animaciones
    8. Autenticaci√≥n - Formularios din√°micos con validaci√≥n
    
    RESPONSIVE DESIGN:
    - Mobile-first approach
    - Breakpoints: 320px, 640px, 768px, 1024px, 1280px
    - Optimizado para touch y interacciones t√°ctiles
    - Tipograf√≠a escalable y espaciado adaptativo
    -->
    
    <!-- Custom Styles and Scripts -->
    <link rel="stylesheet" href="css/custom.css">
    <script src="js/auth-api.js" defer></script>    <style>
        /* 
        ============================================================================
        ESTILOS CR√çTICOS INLINE - OPTIMIZACI√ìN DE RENDERIZADO
        ============================================================================ 
        */
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8FAFC;
            color: #1E293B;
        }
        
        /* Contenedor responsivo para gr√°ficos */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            height: 300px;
        }
        
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        
        /* Estados de navegaci√≥n */
        .nav-link-active {
            color: #0D9488;
            font-weight: 600;
        }
        
        /* Iconos de m√≥dulos */
        .module-card-icon {
            font-size: 2.5rem;
            line-height: 1;
        }
        
        /* Animaciones de descarga optimizadas */
        @keyframes downloadProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
          @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* ===== ANIMACIONES AVANZADAS RESTAURADAS ===== */
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(13, 148, 136, 0.3); }
            50% { box-shadow: 0 0 40px rgba(13, 148, 136, 0.8); }
        }
        
        @keyframes rotate360 {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* ===== CLASES DE ANIMACI√ìN ===== */
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        .animate-slide-up {
            animation: slideInUp 0.6s ease-out;
        }
        
        .animate-slide-left {
            animation: slideInLeft 0.6s ease-out;
        }
        
        .animate-slide-right {
            animation: slideInRight 0.6s ease-out;
        }
        
        .animate-fade-scale {
            animation: fadeInScale 0.5s ease-out;
        }
        
        .animate-glow {
            animation: glow 2s infinite;
        }
        
        .animate-rotate {
            animation: rotate360 2s linear infinite;
        }
        
        .animate-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease-out;
        }
          .animate-on-scroll.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Delays para animaciones escalonadas */
        .animate-delay-1 {
            animation-delay: 0.5s;
        }
        
        .animate-delay-2 {
            animation-delay: 1s;
        }
        
        .animate-delay-3 {
            animation-delay: 1.5s;
        }
        
        /* ===== EFECTOS HOVER MEJORADOS ===== */
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .hover-glow {
            transition: all 0.3s ease;
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 30px rgba(13, 148, 136, 0.4);
            border-color: #0D9488;
        }
        
        .hover-scale {
            transition: transform 0.2s ease;
        }
        
        .hover-scale:hover {
            transform: scale(1.05);
        }
        
        .hover-rotate {
            transition: transform 0.3s ease;
        }
        
        .hover-rotate:hover {
            transform: rotate(5deg);
        }
        
        /* ===== EFECTOS DE M√ìDULOS INTERACTIVOS ===== */
        
        .module-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
        }
        
        .module-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .module-card.expanded {
            transform: scale(1.03);
            z-index: 10;
        }
        
        .module-icon {
            transition: all 0.3s ease;
        }
        
        .module-card:hover .module-icon {
            transform: scale(1.1) rotate(5deg);
            color: #0D9488;
        }
        
        .module-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, padding 0.4s ease;
        }
        
        .module-details.expanded {
            max-height: 300px;
            padding-top: 1rem;
        }
          .download-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: center;
        }
        
        .download-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .download-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #0D9488, #14B8A6, #22D3EE);
            border-radius: 0 0 12px 12px;
            width: 0%;
            transition: width 0.3s ease;
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .downloading {
            animation: pulse 1.5s infinite;
            border-color: #0D9488;
        }
        
        .download-icon {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .download-card:hover .download-icon {
            animation: bounce 1s;
            color: #0D9488;
            transform: scale(1.1);
        }
        
        .download-complete {
            background: linear-gradient(135deg, #0D9488, #14B8A6);
            color: white;
            animation: glow 2s infinite;
        }
        
        .download-complete .download-icon {
            animation: rotate360 1s ease-in-out;
        }
        
        /* Estilos para formularios de autenticaci√≥n */
        .form-message {
            margin-top: 0.75rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .form-message.success {
            background-color: #D1FAE5;
            color: #065F46;
        }
        
        .form-message.error {
            background-color: #FEE2E2;
            color: #991B1B;
        }
        
        /* Chat del asistente IA */
        .chat-container {
            height: 300px;
            overflow-y: auto;
            border: 1px solid #E2E8F0;
            border-radius: 0.5rem;
            padding: 1rem;
            background-color: #F8FAFC;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .chat-message {
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            max-width: 80%;
        }
        
        .chat-message.user {
            background-color: #DCFCE7;
            align-self: flex-end;
        }
        
        .chat-message.ai {
            background-color: #E0F2FE;
            align-self: flex-start;
        }
        
        .chat-loading-indicator {
            align-self: flex-start;
            color: #475569;
            font-style: italic;
        }
        
        /* Optimizaciones para dispositivos t√°ctiles */
        @media (hover: none) and (pointer: coarse) {
            .module-card:hover,
            .download-card:hover {
                transform: none;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            }
            
            .module-card:active,
            .download-card:active {
                transform: scale(0.98);
                transition: transform 0.1s ease;
            }
            
            button:hover {
                transform: none;
            }
            
            button:active {
                transform: scale(0.95);
                transition: transform 0.1s ease;
            }
        }
        
        /* Espaciado adaptativo para diferentes pantallas */
        @media (min-width: 1024px) {
            .container {
                max-width: 1200px;
            }
        }
        
        @media (min-width: 768px) and (max-width: 1023px) {
            .container {
                max-width: 768px;
            }
        }
    </style>
</head>
<body class="bg-slate-50">    <!-- 
    ============================================================================
    HEADER Y NAVEGACI√ìN PRINCIPAL
    ============================================================================ 
    -->
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm" role="banner">
        <nav class="container mx-auto container-padding py-3 flex justify-between items-center" role="navigation" aria-label="Navegaci√≥n principal">
            <h1 class="text-xl sm:text-2xl font-bold text-teal-600">MALINOISE</h1>
            
            <!-- Navegaci√≥n Desktop -->
            <div class="hidden md:flex space-x-4 lg:space-x-6 items-center">
                <a href="#vision" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir a la secci√≥n Visi√≥n">Visi√≥n</a>
                <a href="#modules" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir a la secci√≥n M√≥dulos">M√≥dulos</a>
                <a href="#demo" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir a la demostraci√≥n de IA">Demo IA</a>
                <a href="#tech" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir a la secci√≥n Tecnolog√≠a">Tecnolog√≠a</a>
                <a href="#model" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir al modelo de negocio">Modelo de Negocio</a>
                <a href="#downloads" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir a la secci√≥n Descargas">Descargas</a>
                <a href="#auth" class="nav-link text-slate-600 hover:text-teal-600 transition-colors text-sm lg:text-base" aria-label="Ir a la secci√≥n Autenticaci√≥n">Autenticaci√≥n</a>
                
                <!-- Selector de divisas -->
                <div id="currency-selector-container" class="flex items-center space-x-2" aria-label="Selector de divisas">
                    <i class="fas fa-exchange-alt text-slate-500 text-sm" aria-hidden="true"></i>
                </div>
            </div>

            <!-- Navegaci√≥n m√≥vil -->
            <div class="md:hidden flex items-center space-x-2">
                <!-- Selector de divisas m√≥vil -->
                <div id="currency-selector-mobile" class="flex items-center" aria-label="Selector de divisas m√≥vil">
                    <i class="fas fa-exchange-alt text-slate-500 text-sm mr-1" aria-hidden="true"></i>
                </div>
                
                <button id="mobile-menu-button" class="text-slate-600 focus:outline-none p-2" 
                        aria-label="Abrir men√∫ de navegaci√≥n" 
                        aria-expanded="false" 
                        aria-controls="mobile-menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
            </div>
        </nav>
        
        <!-- Men√∫ m√≥vil -->
        <div id="mobile-menu" class="mobile-menu hidden md:hidden" role="menu" aria-labelledby="mobile-menu-button">
            <a href="#vision" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">Visi√≥n</a>
            <a href="#modules" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">M√≥dulos</a>
            <a href="#demo" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">Demo IA</a>
            <a href="#tech" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">Tecnolog√≠a</a>
            <a href="#model" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">Modelo de Negocio</a>
            <a href="#downloads" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">Descargas</a>
            <a href="#auth" class="mobile-menu-item block text-slate-600 hover:bg-slate-100 hover:text-teal-600" role="menuitem">Autenticaci√≥n</a>
        </div>
    </header><main>        <!-- Secci√≥n de Visi√≥n (Hero) -->
        <section id="vision" class="hero-section py-16 sm:py-20 md:py-24 lg:py-32">
            <div class="container mx-auto container-padding text-center">
                <h2 class="hero-title text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-slate-800 mb-4 sm:mb-6 animate-on-scroll">Tu Asistente de Negocios Inteligente</h2>
                
                <div class="animate-float text-6xl sm:text-7xl md:text-8xl mb-6 sm:mb-8" aria-hidden="true">ü§ñ</div>
                
                <p class="hero-subtitle text-base sm:text-lg md:text-xl text-slate-600 max-w-3xl mx-auto mb-6 sm:mb-8 leading-relaxed animate-on-scroll">
                    Una plataforma integral que no solo organiza el presente de tu negocio, sino que anticipa el futuro, convirtiendo datos en decisiones estrat√©gicas para minimizar p√©rdidas y maximizar el crecimiento.
                </p>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center items-center animate-on-scroll">
                    <a href="#modules" class="inline-block bg-teal-600 text-white font-semibold px-6 sm:px-8 py-3 sm:py-4 rounded-lg hover:bg-teal-700 transition-colors shadow-lg hover:shadow-xl text-sm sm:text-base hover-lift">Explora las Funcionalidades</a>
                    <button id="dashboardAccessBtn" class="inline-block bg-slate-200 text-slate-800 font-semibold px-6 sm:px-8 py-3 sm:py-4 rounded-lg hover:bg-slate-300 transition-colors shadow hover:shadow-lg text-sm sm:text-base hover-lift">Acceder al Dashboard</button>
                </div>
            </div>
        </section>        <!-- Secci√≥n de M√≥dulos Interactivos -->
        <section id="modules" class="section-padding py-16 sm:py-20 bg-white">
            <div class="container mx-auto container-padding">
                <div class="text-center mb-8 sm:mb-12 animate-on-scroll">
                    <h3 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 mb-3 sm:mb-4">M√≥dulos y Funcionalidades Clave</h3>
                    <p class="text-base sm:text-lg text-slate-600">Un ecosistema completo para potenciar cada √°rea de tu emprendimiento. <span class="mobile-hidden">Haz clic en cada m√≥dulo para ver los detalles.</span></p>
                </div>
                <div class="modules-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">                    
                    <div class="module-card bg-slate-50 p-4 sm:p-6 rounded-xl shadow-sm cursor-pointer hover:shadow-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-teal-600 hover-lift animate-on-scroll" data-module="1" tabindex="0">
                        <div class="flex items-center space-x-3 sm:space-x-4">
                            <div class="module-icon module-card-icon text-3xl sm:text-4xl">üìà</div>
                            <h4 class="module-title text-lg sm:text-xl font-semibold text-slate-800">Gesti√≥n del Negocio</h4>
                        </div>
                        <p class="text-slate-600 mt-2 text-sm sm:text-base">La base de operaciones para configurar, monitorear y controlar tu negocio.</p>
                        <div class="module-details hidden mt-4 pt-4 border-t border-slate-200 text-xs sm:text-sm text-slate-600 space-y-2">
                            <p>‚úì Dashboard personalizable con KPIs</p>
                            <p>‚úì Registro de ventas y compras</p>
                            <p>‚úì Generaci√≥n de facturas simplificadas</p>
                            <p>‚úì CRM b√°sico de clientes y proveedores</p>
                        </div>
                    </div>
                    
                    <div class="module-card bg-slate-50 p-6 rounded-xl shadow-sm cursor-pointer hover:shadow-lg transition-all duration-300 hover-lift animate-on-scroll" data-module="2">
                        <div class="flex items-center space-x-4">
                           <div class="module-icon module-card-icon">üì¶</div>
                            <h4 class="text-xl font-semibold text-slate-800">Inventario Inteligente</h4>
                        </div>
                        <p class="text-slate-600 mt-2">Optimiza tu stock con alertas y sugerencias autom√°ticas.</p>
                        <div class="module-details hidden mt-4 pt-4 border-t border-slate-200 text-sm text-slate-600 space-y-2">
                            <p>‚úì Registro detallado de productos (SKU)</p>
                            <p>‚úì Historial de movimientos de inventario</p>
                            <p>‚úì Alertas de stock m√≠nimo y m√°ximo</p>
                            <p>‚úì Sugerencias de reabastecimiento (IA)</p>
                        </div>
                    </div>

                    <div class="module-card bg-slate-50 p-6 rounded-xl shadow-sm cursor-pointer hover:shadow-lg transition-all duration-300 hover-lift animate-on-scroll" data-module="3">
                        <div class="flex items-center space-x-4">
                            <div class="module-icon module-card-icon">üîÆ</div>
                            <h4 class="text-xl font-semibold text-slate-800">An√°lisis Predictivo</h4>
                        </div>
                        <p class="text-slate-600 mt-2">Antic√≠pate a los problemas y oportunidades con el poder de la IA.</p>
                        <div class="module-details hidden mt-4 pt-4 border-t border-slate-200 text-sm text-slate-600 space-y-2">
                            <p>‚úì Detecci√≥n de anomal√≠as en gastos/ventas</p>
                            <p>‚úì Predicci√≥n de flujo de caja</p>
                            <p>‚úì Simulaci√≥n de escenarios de negocio</p>
                            <p>‚úì Recomendaciones proactivas para evitar p√©rdidas</p>
                        </div>
                    </div>                    <div class="module-card bg-slate-50 p-6 rounded-xl shadow-sm cursor-pointer hover:shadow-lg transition-all duration-300 hover-lift animate-on-scroll" data-module="4">
                        <div class="flex items-center space-x-4">
                            <div class="module-icon module-card-icon animate-glow">ü§ñ</div>
                            <h4 class="text-xl font-semibold text-slate-800">Asistente IA ‚ú®</h4>
                        </div>
                        <p class="text-slate-600 mt-2">Tu consejero estrat√©gico personal, disponible 24/7. ¬°Pru√©balo abajo!</p>
                        <div class="module-details hidden mt-4 pt-4 border-t border-slate-200 text-sm text-slate-600 space-y-2">
                            <p>‚úì Interfaz conversacional (chat/voz)</p>
                            <p>‚úì Consultas en lenguaje natural</p>
                            <p>‚úì Consejos estrat√©gicos personalizados</p>
                            <p>‚úì Automatizaci√≥n de informes a petici√≥n</p>

                            <!-- Secci√≥n del chat del Asistente IA -->
                            <div class="mt-4 p-4 border border-teal-200 bg-white rounded-lg shadow-inner hover-glow">
                                <h5 class="text-base font-semibold text-teal-700 mb-3">Chatea con tu Asistente ‚ú®</h5>
                                <div id="aiAssistantChat" class="chat-container">
                                    <!-- Los mensajes del chat se insertar√°n aqu√≠ -->
                                    <div class="chat-message ai">Hola, soy tu asistente de negocios. ¬øEn qu√© puedo ayudarte hoy?</div>
                                </div>
                                <div class="flex mt-4 gap-2">
                                    <input type="text" id="aiAssistantInput" placeholder="Haz una pregunta a tu asistente..." class="flex-1 p-2 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-slate-800">
                                    <button id="sendAiMessage" class="bg-teal-600 text-white font-semibold px-4 py-2 rounded-lg hover:bg-teal-700 transition-colors shadow hover-scale">
                                        Enviar
                                    </button>
                                </div>
                                <div id="aiAssistantLoading" class="chat-loading-indicator hidden mt-2">Cargando respuesta...</div>
                            </div>
                        </div>
                    </div>

                    <div class="module-card bg-slate-50 p-6 rounded-xl shadow-sm cursor-pointer hover:shadow-lg transition-all duration-300 hover-lift animate-on-scroll" data-module="5">
                        <div class="flex items-center space-x-4">
                            <div class="module-icon module-card-icon">‚öôÔ∏è</div>
                            <h4 class="text-xl font-semibold text-slate-800">Automatizaci√≥n</h4>
                        </div>
                        <p class="text-slate-600 mt-2">Ahorra tiempo y reduce errores automatizando tareas repetitivas.</p>
                         <div class="module-details hidden mt-4 pt-4 border-t border-slate-200 text-sm text-slate-600 space-y-2">
                            <p>‚úì Programaci√≥n de tareas y recordatorios</p>
                            <p>‚úì Automatizaci√≥n de informes regulares</p>
                            <p>‚úì Integraci√≥n con calendario</p>
                            <p>‚úì Gesti√≥n de documentos en la nube</p>
                        </div>
                    </div>

                    <div class="module-card bg-slate-50 p-6 rounded-xl shadow-sm cursor-pointer hover:shadow-lg transition-all duration-300 hover-lift animate-on-scroll" data-module="6">
                        <div class="flex items-center space-x-4">
                            <div class="module-icon module-card-icon">üîî</div>
                            <h4 class="text-xl font-semibold text-slate-800">Alertas Inteligentes</h4>
                        </div>
                        <p class="text-slate-600 mt-2">Mantente informado de lo importante, sin el ruido innecesario.</p>
                        <div class="module-details hidden mt-4 pt-4 border-t border-slate-200 text-sm text-slate-600 space-y-2">
                            <p>‚úì Notificaciones push personalizables</p>
                            <p>‚úì Alertas de anomal√≠as detectadas por IA</p>
                            <p>‚úì Recordatorios de pagos y cobros</p>
                            <p>‚úì Res√∫menes ejecutivos diarios</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>          <!-- Secci√≥n de Demostraci√≥n Visual (Gr√°fico IA) -->
        <section id="demo" class="section-padding py-16 sm:py-20">
            <div class="container mx-auto container-padding">
                <div class="text-center mb-8 sm:mb-12 animate-on-scroll">
                    <h3 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 mb-3 sm:mb-4">El Poder de la Predicci√≥n en Acci√≥n</h3>
                    <p class="text-sm sm:text-base lg:text-lg text-slate-600">Este gr√°fico simula c√≥mo Malinoise analiza tus ventas, predice tendencias y detecta anomal√≠as, permiti√©ndote actuar a tiempo. <span class="mobile-hidden">Interact√∫a con los botones para ver las capacidades de la IA.</span></p>
                </div>
                <div class="bg-white p-4 sm:p-6 rounded-xl shadow-lg hover-lift animate-on-scroll">
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                    <div class="chart-controls mt-4 sm:mt-6 flex justify-center items-center flex-wrap gap-3 sm:gap-4">
                        <button id="togglePrediction" class="chart-control-btn bg-teal-600 text-white text-xs sm:text-sm font-semibold px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg hover:bg-teal-700 transition-colors flex items-center justify-center hover-scale">
                            <span class="mobile-hidden">Ocultar </span>Predicci√≥n IA
                        </button>
                        <button id="toggleAnomaly" class="chart-control-btn bg-amber-500 text-white text-xs sm:text-sm font-semibold px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg hover:bg-amber-600 transition-colors flex items-center justify-center hover-scale">
                            <span class="mobile-hidden">Ocultar </span>Anomal√≠as
                        </button>
                    </div>
                </div>
            </div>
        </section>        <!-- Secci√≥n de Tecnolog√≠a -->
        <section id="tech" class="section-padding py-16 sm:py-20 bg-white">
            <div class="container mx-auto container-padding">
                <div class="text-center mb-8 sm:mb-12 animate-on-scroll">
                    <h3 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 mb-3 sm:mb-4">Tecnolog√≠a Escalable y Segura</h3>
                    <p class="text-sm sm:text-base lg:text-lg text-slate-600">Construimos sobre una base moderna y robusta para garantizar rendimiento y fiabilidad.</p>
                </div>
                <div class="max-w-4xl mx-auto space-y-6 sm:space-y-8">
                     <div class="tech-item text-center p-4 sm:p-6 bg-slate-50 rounded-xl hover-lift animate-on-scroll">
                        <div class="text-4xl mb-3 animate-float">üì±</div>
                        <h4 class="font-semibold text-base sm:text-lg text-teal-600">Frontend (App M√≥vil)</h4>
                        <p class="text-xl sm:text-2xl font-bold mt-1">React Native</p>
                        <p class="text-slate-600 text-xs sm:text-sm mt-1">Para una experiencia nativa y fluida en iOS y Android.</p>
                    </div>
                    <div class="flex justify-center mobile-hidden">
                        <div class="h-6 sm:h-8 w-px bg-slate-300"></div>
                    </div>                    <div class="tech-item text-center p-4 sm:p-6 bg-slate-50 rounded-xl hover-lift animate-on-scroll">
                        <div class="text-4xl mb-3 animate-float animate-delay-1">‚òÅÔ∏è</div>
                        <h4 class="font-semibold text-base sm:text-lg text-teal-600">Backend & Base de Datos</h4>
                        <p class="text-xl sm:text-2xl font-bold mt-1">Firebase / AWS Amplify</p>
                        <p class="text-slate-600 text-xs sm:text-sm mt-1">Servicios en la nube para sincronizaci√≥n en tiempo real, autenticaci√≥n y escalabilidad.</p>
                    </div>
                    <div class="flex justify-center mobile-hidden">
                        <div class="h-6 sm:h-8 w-px bg-slate-300"></div>
                    </div>
                    <div class="tech-item text-center p-4 sm:p-6 bg-slate-50 rounded-xl hover-lift animate-on-scroll">
                        <div class="text-4xl mb-3 animate-float animate-delay-2">üß†</div>
                        <h4 class="font-semibold text-base sm:text-lg text-teal-600">Inteligencia Artificial</h4>
                        <p class="text-xl sm:text-2xl font-bold mt-1">Google Cloud AI / AWS AI</p>
                        <p class="text-slate-600 text-xs sm:text-sm mt-1">APIs y modelos optimizados para an√°lisis predictivo y el asistente conversacional.</p>
                    </div>
                </div>
            </div>
        </section>        <!-- Secci√≥n de Modelo de Negocio -->
        <section id="model" class="section-padding py-16 sm:py-20">
             <div class="container mx-auto container-padding">
                <div class="text-center mb-8 sm:mb-12 animate-on-scroll">
                    <h3 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 mb-3 sm:mb-4">Modelo de Negocio Flexible</h3>
                    <p class="text-sm sm:text-base lg:text-lg text-slate-600">Un plan para crecer contigo. Empieza gratis y desbloquea m√°s poder cuando lo necesites.</p>
                </div>
                <div class="pricing-table grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8 max-w-4xl mx-auto">
                    <div class="pricing-column border border-slate-200 rounded-xl p-6 sm:p-8 bg-white shadow-sm hover-lift animate-on-scroll">
                        <div class="text-center mb-4">
                            <div class="text-5xl mb-3">üí°</div>
                            <h4 class="pricing-header text-xl sm:text-2xl font-bold text-slate-800 mb-2">Freemium</h4>
                            <p class="text-slate-600 text-sm sm:text-base mb-4 sm:mb-6">Ideal para empezar y organizar tu negocio.</p>
                        </div>
                        <ul class="space-y-2 sm:space-y-3 text-slate-600 text-sm sm:text-base">
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Gesti√≥n de negocio b√°sica</li>
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Inventario con alertas</li>
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Registro de hasta 100 productos</li>
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Notificaciones est√°ndar</li>
                        </ul>
                    </div>
                     <div class="pricing-column border-2 border-teal-500 rounded-xl p-6 sm:p-8 bg-white shadow-lg relative hover-lift animate-glow animate-on-scroll">
                        <div class="absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 bg-teal-500 text-white text-xs font-bold px-3 py-1 rounded-full mobile-hidden">M√ÅS POPULAR</div>
                        <div class="text-center mb-4">
                            <div class="text-5xl mb-3 animate-glow">‚≠ê</div>
                            <h4 class="pricing-header text-xl sm:text-2xl font-bold text-slate-800 mb-2">Premium</h4>
                            <p class="text-slate-600 text-sm sm:text-base mb-4 sm:mb-6">Para emprendedores que buscan optimizar y predecir.</p>
                        </div>
                        <ul class="space-y-2 sm:space-y-3 text-slate-600 text-sm sm:text-base">
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Todo lo de Freemium</li>
                            <li class="pricing-cell flex items-center font-semibold"><span class="text-teal-500 mr-3 text-lg">‚úî</span>An√°lisis Predictivo IA</li>
                            <li class="pricing-cell flex items-center font-semibold"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Asistente IA</li>
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Productos ilimitados</li>
                            <li class="pricing-cell flex items-center"><span class="text-teal-500 mr-3 text-lg">‚úî</span>Integraciones y Add-ons</li>
                        </ul>
                    </div>
                </div>
             </div>
        </section><!-- Secci√≥n de Descargas con Animaciones -->
        <section id="downloads" class="section-padding py-16 sm:py-20 bg-white">
            <div class="container mx-auto container-padding text-center">
                <div class="animate-on-scroll">
                    <h3 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 mb-3 sm:mb-4">Descarga Malinoise en tu Dispositivo</h3>
                    <p class="text-sm sm:text-base lg:text-lg text-slate-600 max-w-2xl mx-auto mb-8 sm:mb-12">
                        Malinoise estar√° disponible en todas tus plataformas preferidas. Accede a tu negocio desde cualquier lugar, manteniendo tus datos sincronizados.
                    </p>
                </div>
                <div class="downloads-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 max-w-4xl mx-auto">
                    <div class="download-card relative flex flex-col items-center p-4 sm:p-6 bg-slate-50 rounded-xl shadow-md hover:shadow-lg cursor-pointer transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-teal-600 hover-lift animate-on-scroll" data-platform="desktop" tabindex="0">
                        <span class="download-icon text-4xl sm:text-5xl mb-2 sm:mb-3">üíª</span>
                        <span class="text-base sm:text-lg font-semibold text-slate-800">Escritorio</span>
                        <span class="text-xs sm:text-sm text-slate-600 mb-2">Windows/macOS</span>
                        <div class="download-status text-xs text-slate-500 mobile-center">Toca para descargar</div>
                        <div class="download-progress"></div>
                    </div>
                    <div class="download-card relative flex flex-col items-center p-4 sm:p-6 bg-slate-50 rounded-xl shadow-md hover:shadow-lg cursor-pointer transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-teal-600 hover-lift animate-on-scroll" data-platform="ios" tabindex="0">
                        <span class="download-icon text-4xl sm:text-5xl mb-2 sm:mb-3">üì±</span>
                        <span class="text-base sm:text-lg font-semibold text-slate-800">iOS</span>
                        <span class="text-xs sm:text-sm text-slate-600 mb-2">iPhone</span>
                        <div class="download-status text-xs text-slate-500 mobile-center">Toca para descargar</div>
                        <div class="download-progress"></div>
                    </div>
                    <div class="download-card relative flex flex-col items-center p-4 sm:p-6 bg-slate-50 rounded-xl shadow-md hover:shadow-lg cursor-pointer transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-teal-600 hover-lift animate-on-scroll" data-platform="ipad" tabindex="0">
                        <span class="download-icon text-4xl sm:text-5xl mb-2 sm:mb-3">üì±</span>
                        <span class="text-base sm:text-lg font-semibold text-slate-800">iPad</span>
                        <span class="text-xs sm:text-sm text-slate-600 mb-2">Tablet Apple</span>
                        <div class="download-status text-xs text-slate-500 mobile-center">Toca para descargar</div>
                        <div class="download-progress"></div>
                    </div>
                    <div class="download-card relative flex flex-col items-center p-4 sm:p-6 bg-slate-50 rounded-xl shadow-md hover:shadow-lg cursor-pointer transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-teal-600 hover-lift animate-on-scroll" data-platform="android" tabindex="0">
                        <span class="download-icon text-4xl sm:text-5xl mb-2 sm:mb-3">ü§ñ</span>
                        <span class="text-base sm:text-lg font-semibold text-slate-800">Android</span>
                        <span class="text-xs sm:text-sm text-slate-600 mb-2">Tel√©fono/Tablet</span>
                        <div class="download-status text-xs text-slate-500 mobile-center">Toca para descargar</div>
                        <div class="download-progress"></div>
                    </div>
                </div>
            </div>
        </section>        <!-- Secci√≥n de Autenticaci√≥n con Formularios Din√°micos -->
        <section id="auth" class="section-padding py-16 sm:py-20">
            <div class="container mx-auto container-padding text-center">
                <div class="animate-on-scroll">
                    <h3 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold text-slate-800 mb-3 sm:mb-4">Accede a tu Cuenta Malinoise</h3>
                    <p class="text-sm sm:text-base lg:text-lg text-slate-600 max-w-2xl mx-auto mb-6 sm:mb-8">
                        Gestiona tu negocio de forma segura. Inicia sesi√≥n o reg√≠strate para comenzar a transformar tus operaciones.
                    </p>
                </div>
                <div class="auth-container max-w-sm sm:max-w-md mx-auto p-6 sm:p-8 bg-white rounded-xl shadow-lg hover-lift animate-on-scroll">
                    <div class="auth-tabs flex justify-center mb-4 sm:mb-6 border-b border-slate-200 flex-wrap">
                        <button id="showLogin" class="auth-tab px-3 sm:px-4 py-2 text-xs sm:text-sm text-slate-600 font-semibold border-b-2 border-transparent hover:border-teal-600 transition-colors">Iniciar Sesi√≥n</button>
                        <button id="showRegister" class="auth-tab px-3 sm:px-4 py-2 text-xs sm:text-sm text-slate-600 font-semibold border-b-2 border-transparent hover:border-teal-600 transition-colors">Registrarse</button>
                        <button id="showRecover" class="auth-tab px-3 sm:px-4 py-2 text-xs sm:text-sm text-slate-600 font-semibold border-b-2 border-transparent hover:border-teal-600 transition-colors">Recuperar</button>
                    </div>

                    <div id="loginForm" class="auth-form space-y-3 sm:space-y-4">
                        <h4 class="text-lg sm:text-xl font-semibold text-slate-800 mb-3 sm:mb-4">Iniciar Sesi√≥n</h4>
                        <input type="email" placeholder="Correo Electr√≥nico" class="auth-input w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm sm:text-base" id="loginEmail">
                        <input type="password" placeholder="Contrase√±a" class="auth-input w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm sm:text-base" id="loginPassword">
                        <button class="auth-button w-full bg-teal-600 text-white font-semibold py-3 rounded-lg hover:bg-teal-700 transition-colors shadow text-sm sm:text-base" id="loginButton">
                            Iniciar Sesi√≥n
                        </button>
                        <div id="loginMessage" class="form-message hidden text-sm"></div>
                    </div>                    <div id="registerForm" class="auth-form hidden space-y-3 sm:space-y-4">
                        <h4 class="text-lg sm:text-xl font-semibold text-slate-800 mb-3 sm:mb-4">Registrarse</h4>
                        <input type="text" placeholder="Nombre Completo" class="auth-input w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm sm:text-base" id="registerName">
                        <input type="email" placeholder="Correo Electr√≥nico" class="auth-input w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm sm:text-base" id="registerEmail">
                        <input type="password" placeholder="Contrase√±a" class="auth-input w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm sm:text-base" id="registerPassword">
                        <input type="password" placeholder="Confirmar Contrase√±a" class="auth-input w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-sm sm:text-base" id="confirmPassword">
                        <button class="auth-button w-full bg-teal-600 text-white font-semibold py-3 rounded-lg hover:bg-teal-700 transition-colors shadow text-sm sm:text-base" id="registerButton">
                            Registrarse
                        </button>
                        <div id="registerMessage" class="form-message hidden text-sm"></div>
                    </div><div id="recoverForm" class="auth-form hidden space-y-4">
                        <!-- Paso 1: Solicitar c√≥digo -->
                        <div id="recoverStep1" class="space-y-4">
                            <h4 class="text-xl font-semibold text-slate-800 mb-4">Recuperar Contrase√±a</h4>
                            <p class="text-sm text-slate-600">Ingresa tu correo electr√≥nico y te enviaremos un c√≥digo de 6 d√≠gitos para restablecer tu contrase√±a.</p>
                            <input type="email" placeholder="Correo Electr√≥nico" class="w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500" id="recoverEmail">
                            <button class="w-full bg-teal-600 text-white font-semibold py-3 rounded-lg hover:bg-teal-700 transition-colors shadow" id="recoverButton">
                                Enviar C√≥digo
                            </button>
                        </div>
                        
                        <!-- Paso 2: Verificar c√≥digo y nueva contrase√±a -->
                        <div id="recoverStep2" class="hidden space-y-4">
                            <h4 class="text-xl font-semibold text-slate-800 mb-4">Ingresar C√≥digo y Nueva Contrase√±a</h4>
                            <p class="text-sm text-slate-600 mb-4">Hemos enviado un c√≥digo de 6 d√≠gitos a: <span id="recoverEmailDisplay" class="font-semibold text-teal-600"></span></p>
                            <input type="text" placeholder="C√≥digo de 6 d√≠gitos" maxlength="6" class="w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-center text-lg font-mono tracking-wider" id="recoveryCode">
                            <input type="password" placeholder="Nueva Contrase√±a" class="w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500" id="newPassword">
                            <input type="password" placeholder="Confirmar Nueva Contrase√±a" class="w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500" id="confirmNewPassword">
                            <button class="w-full bg-teal-600 text-white font-semibold py-3 rounded-lg hover:bg-teal-700 transition-colors shadow" id="resetPasswordButton">
                                Actualizar Contrase√±a
                            </button>
                            <button class="w-full bg-slate-200 text-slate-800 font-semibold py-2 rounded-lg hover:bg-slate-300 transition-colors" id="resendRecoveryButton">
                                Reenviar C√≥digo
                            </button>
                        </div>
                        
                        <div id="recoverMessage" class="form-message hidden"></div>
                    </div>

                    <div id="verificationForm" class="auth-form hidden space-y-4">
                        <h4 class="text-xl font-semibold text-slate-800 mb-4">Verificar Email</h4>
                        <p class="text-sm text-slate-600 mb-4">Hemos enviado un c√≥digo de verificaci√≥n de 6 d√≠gitos a tu correo electr√≥nico.</p>
                        <p id="verificationEmail" class="text-sm font-semibold text-teal-600 mb-4"></p>
                        <div class="space-y-4">
                            <input type="text" placeholder="C√≥digo de 6 d√≠gitos" maxlength="6" class="w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-teal-500 text-center text-lg font-mono tracking-wider" id="verificationCode">
                            <p class="text-xs text-slate-500">Para prop√≥sitos de demostraci√≥n, el c√≥digo es: <span id="demoCode" class="font-mono font-bold text-teal-600"></span></p>
                            <button class="w-full bg-teal-600 text-white font-semibold py-3 rounded-lg hover:bg-teal-700 transition-colors shadow" id="verifyButton">
                                Verificar C√≥digo
                            </button>
                            <button class="w-full bg-slate-200 text-slate-800 font-semibold py-2 rounded-lg hover:bg-slate-300 transition-colors" id="resendCodeButton">
                                Reenviar C√≥digo
                            </button>
                        </div>
                        <div id="verificationMessage" class="form-message hidden text-sm"></div>
                    </div>
                </div>
            </div>
        </section>    </main>
    
    <footer class="bg-slate-800 text-white py-6 sm:py-8">
        <div class="container mx-auto container-padding text-center text-slate-400">
            <p class="text-sm sm:text-base">&copy; 2025 Malinoise. Conceptualizaci√≥n de una aplicaci√≥n de negocios.</p>
        </div>
    </footer>

    <!-- JavaScript para funcionalidad interactiva -->    <script>        document.addEventListener('DOMContentLoaded', () => {
            // Verificar autenticaci√≥n y redirigir si es necesario
            if (window.authAPI && window.authAPI.isAuthenticated()) {
                // Si ya est√° autenticado, redirigir al dashboard
                window.location.href = '/dashboard';
                return;            }

            // Configurar el bot√≥n de acceso al dashboard
            const dashboardAccessBtn = document.getElementById('dashboardAccessBtn');
            if (dashboardAccessBtn) {
                dashboardAccessBtn.addEventListener('click', () => {
                    // Verificar nuevamente si est√° autenticado
                    if (window.authAPI && window.authAPI.isAuthenticated()) {
                        console.log('üîÑ Accediendo al dashboard desde bot√≥n...');
                        // Usar dashboard.html directamente para mayor compatibilidad
                        window.location.href = 'dashboard.html';
                    } else {
                        // Si no est√° autenticado, ir a la secci√≥n de autenticaci√≥n
                        alert('Debes iniciar sesi√≥n primero para acceder al dashboard.');
                        document.getElementById('auth').scrollIntoView({ behavior: 'smooth' });
                    }
                });
            }

            // Funcionalidad del men√∫ m√≥vil
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            document.querySelectorAll('#mobile-menu a').forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });            // Funcionalidad de las tarjetas de m√≥dulos (acorde√≥n) mejorada
            const moduleCards = document.querySelectorAll('.module-card');
            moduleCards.forEach(card => {
                card.addEventListener('click', () => {
                    const details = card.querySelector('.module-details');
                    const icon = card.querySelector('.module-icon');
                    
                    // Toggle del contenido con animaciones mejoradas
                    if (details.classList.contains('hidden')) {
                        // Expandir
                        details.classList.remove('hidden');
                        card.classList.add('expanded');
                        card.classList.add('bg-white');
                        card.classList.remove('bg-slate-50');
                        
                        if (icon) {
                            icon.style.transform = 'scale(1.1) rotate(10deg)';
                            icon.style.color = '#0D9488';
                        }
                        
                        // Usar requestAnimationFrame para animaci√≥n suave
                        requestAnimationFrame(() => {
                            details.style.maxHeight = details.scrollHeight + 'px';
                        });
                        
                    } else {
                        // Contraer
                        details.style.maxHeight = '0px';
                        card.classList.remove('expanded');
                        card.classList.remove('bg-white');
                        card.classList.add('bg-slate-50');
                        
                        if (icon) {
                            icon.style.transform = 'scale(1) rotate(0deg)';
                            icon.style.color = '';
                        }
                        
                        // Esperar a que termine la animaci√≥n antes de ocultar
                        setTimeout(() => {
                            details.classList.add('hidden');
                            details.style.maxHeight = '';
                        }, 400);
                    }
                });
            });

            // Configuraci√≥n del gr√°fico interactivo con Chart.js
            const ctx = document.getElementById('salesChart').getContext('2d');
            const salesData = {
                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],
                datasets: [
                    {
                        label: 'Ventas Hist√≥ricas (‚Ç¨)',
                        data: [1200, 1900, 3000, 5000, 2300, 3100, 4200, 3500, 2800, 4500, 4800, 6000],
                        borderColor: 'rgb(59, 130, 246)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4,
                    },
                    {
                        label: 'Predicci√≥n IA (‚Ç¨)',
                        data: [1300, 2000, 2800, 4800, 2500, 3300, 4400, 3700, 3000, 4700, 5000, 6300],
                        borderColor: 'rgb(13, 148, 136)',
                        borderDash: [5, 5],
                        fill: false,
                        tension: 0.4,
                    },
                    {
                        label: 'Anomal√≠a Detectada',
                        data: [null, null, null, null, null, null, null, 3500, null, null, null, null],
                        borderColor: 'rgb(245, 158, 11)',
                        backgroundColor: 'rgba(245, 158, 11, 0.5)',
                        pointRadius: 8,
                        pointHoverRadius: 10,
                        showLine: false,
                        type: 'bubble'
                    }
                ]
            };

            const salesChart = new Chart(ctx, {
                type: 'line',
                data: salesData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        label += new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR' }).format(context.parsed.y);
                                    }
                                    if(context.dataset.label === 'Anomal√≠a Detectada') {
                                       return 'Anomal√≠a: Ca√≠da inesperada en ventas';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Funcionalidad de los botones del gr√°fico
            document.getElementById('togglePrediction').addEventListener('click', (e) => {
                const isVisible = salesChart.isDatasetVisible(1);
                salesChart.setDatasetVisibility(1, !isVisible);
                salesChart.update();
                e.target.textContent = isVisible ? 'Mostrar Predicci√≥n IA' : 'Ocultar Predicci√≥n IA';
                e.target.classList.toggle('bg-slate-400', isVisible);
                e.target.classList.toggle('bg-teal-600', !isVisible);
            });
            
            document.getElementById('toggleAnomaly').addEventListener('click', (e) => {
                const isVisible = salesChart.isDatasetVisible(2);
                salesChart.setDatasetVisibility(2, !isVisible);
                salesChart.update();
                e.target.textContent = isVisible ? 'Mostrar Anomal√≠as' : 'Ocultar Anomal√≠as';
                e.target.classList.toggle('bg-slate-400', isVisible);
                e.target.classList.toggle('bg-amber-500', !isVisible);
            });            // Navegaci√≥n activa por scroll
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('main section');

            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 65) {
                        current = section.getAttribute('id');
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('nav-link-active');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('nav-link-active');                    }
                });
            });

            // ============================================================
            // SISTEMA DE ANIMACIONES DE SCROLL
            // ============================================================
            
            /**
             * Configura el observador de intersecci√≥n para las animaciones de scroll
             */
            function initScrollAnimations() {
                const observerOptions = {
                    threshold: 0.1,
                    rootMargin: '0px 0px -50px 0px'
                };

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            // Una vez visible, ya no necesitamos observarlo
                            observer.unobserve(entry.target);
                        }
                    });
                }, observerOptions);

                // Observar todos los elementos con la clase animate-on-scroll
                const elementsToAnimate = document.querySelectorAll('.animate-on-scroll');
                elementsToAnimate.forEach(element => {
                    observer.observe(element);
                });
            }

            /**
             * Mejora la funcionalidad de los m√≥dulos con efectos visuales
             */
            function enhanceModuleInteractions() {
                const moduleCards = document.querySelectorAll('.module-card');
                
                moduleCards.forEach((card, index) => {
                    // Agregar delay escalonado para la animaci√≥n inicial
                    card.style.animationDelay = `${index * 0.1}s`;
                    
                    // Efectos hover mejorados
                    card.addEventListener('mouseenter', () => {
                        const icon = card.querySelector('.module-icon');
                        if (icon) {
                            icon.style.transform = 'scale(1.1) rotate(5deg)';
                            icon.style.transition = 'transform 0.3s ease';
                        }
                    });
                    
                    card.addEventListener('mouseleave', () => {
                        const icon = card.querySelector('.module-icon');
                        if (icon && !card.classList.contains('expanded')) {
                            icon.style.transform = 'scale(1) rotate(0deg)';
                        }
                    });
                });
            }

            /**
             * A√±ade efectos de part√≠culas flotantes al hero
             */
            function addFloatingParticles() {
                const heroSection = document.querySelector('#vision');
                if (!heroSection) return;
                
                // Crear contenedor de part√≠culas
                const particlesContainer = document.createElement('div');
                particlesContainer.className = 'absolute inset-0 overflow-hidden pointer-events-none';
                particlesContainer.style.zIndex = '0';
                
                // Crear part√≠culas
                for (let i = 0; i < 6; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'absolute opacity-10 text-teal-500';
                    particle.innerHTML = ['üí°', 'üìà', 'ü§ñ', '‚ö°', 'üéØ', '‚ú®'][i];
                    particle.style.fontSize = '2rem';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 5 + 's';
                    particle.classList.add('animate-float');
                    
                    particlesContainer.appendChild(particle);
                }
                
                // Hacer el hero section relativo para contener las part√≠culas
                heroSection.style.position = 'relative';
                heroSection.insertBefore(particlesContainer, heroSection.firstChild);
            }

            // Inicializar todas las mejoras
            initScrollAnimations();
            enhanceModuleInteractions();
            addFloatingParticles();
            
            console.log('‚ú® Animaciones y efectos visuales inicializados correctamente');
            
            // Funcionalidad de animaci√≥n de descarga
            const downloadCards = document.querySelectorAll('.download-card');
            
            downloadCards.forEach(card => {
                card.addEventListener('click', function() {
                    const platform = this.dataset.platform;
                    const progressBar = this.querySelector('.download-progress');
                    const statusElement = this.querySelector('.download-status');
                    const icon = this.querySelector('.download-icon');
                    
                    // Prevenir m√∫ltiples clics
                    if (this.classList.contains('downloading')) return;
                    
                    // Iniciar descarga
                    this.classList.add('downloading');
                    statusElement.textContent = 'Iniciando descarga...';
                    
                    // Animaci√≥n de progreso
                    setTimeout(() => {
                        progressBar.style.animation = 'downloadProgress 3s ease-out forwards';
                        statusElement.textContent = 'Descargando...';
                    }, 500);
                      // Completar descarga
                    setTimeout(() => {
                        this.classList.remove('downloading');
                        this.classList.add('download-complete');
                        statusElement.textContent = '¬°Descarga completada!';
                        icon.textContent = '‚úì';
                        
                        // Si es escritorio, redirigir a la versi√≥n web despu√©s de mostrar el √©xito
                        if (platform === 'desktop') {
                            setTimeout(() => {
                                statusElement.textContent = 'Abriendo versi√≥n web...';
                                setTimeout(() => {
                                    window.location.href = '#auth';
                                    // Scroll suave hacia la secci√≥n de autenticaci√≥n
                                    document.getElementById('auth').scrollIntoView({ behavior: 'smooth' });
                                }, 1000);
                            }, 1500);
                        } else {
                            // Para otras plataformas, mantener el comportamiento original
                            setTimeout(() => {
                                this.classList.remove('download-complete');
                                progressBar.style.animation = 'none';
                                progressBar.style.width = '0%';
                                statusElement.textContent = 'Toca para descargar';
                                
                                // Restaurar icono original
                                switch(platform) {
                                    case 'ios':
                                        icon.textContent = 'üì±';
                                        break;
                                    case 'ipad':
                                        icon.textContent = 'üì±';
                                        break;
                                    case 'android':
                                        icon.textContent = 'ü§ñ';
                                        break;
                                }
                            }, 3000);
                        }
                    }, 3500);
                });
            });
            
            // ============================================================
            // FORMULARIOS DE AUTENTICACI√ìN DIN√ÅMICOS
            // ============================================================
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const recoverForm = document.getElementById('recoverForm');

            const showLoginBtn = document.getElementById('showLogin');
            const showRegisterBtn = document.getElementById('showRegister');
            const showRecoverBtn = document.getElementById('showRecover');

            const loginMessage = document.getElementById('loginMessage');
            const registerMessage = document.getElementById('registerMessage');
            const recoverMessage = document.getElementById('recoverMessage');

            /**
             * Funci√≥n para mostrar un formulario espec√≠fico y ocultar los dem√°s
             * @param {HTMLElement} formToShow - El formulario que se va a mostrar
             */
            function showForm(formToShow) {
                // Ocultar todos los formularios
                [loginForm, registerForm, recoverForm].forEach(form => form.classList.add('hidden'));
                // Quitar el borde activo de todos los botones
                [showLoginBtn, showRegisterBtn, showRecoverBtn].forEach(btn => btn.classList.remove('border-teal-600'));
                
                // Mostrar el formulario seleccionado y activar su bot√≥n
                formToShow.classList.remove('hidden');
                if (formToShow === loginForm) showLoginBtn.classList.add('border-teal-600');
                else if (formToShow === registerForm) showRegisterBtn.classList.add('border-teal-600');
                else if (formToShow === recoverForm) showRecoverBtn.classList.add('border-teal-600');
                
                // Limpiar mensajes al cambiar de formulario
                [loginMessage, registerMessage, recoverMessage].forEach(msg => msg.classList.add('hidden'));
            }

            // Event listeners para cambiar entre formularios
            showLoginBtn.addEventListener('click', () => showForm(loginForm));
            showRegisterBtn.addEventListener('click', () => showForm(registerForm));
            showRecoverBtn.addEventListener('click', () => showForm(recoverForm));

            // Mostrar formulario de login por defecto
            showForm(loginForm);            // ============================================================
            // L√ìGICA DE INICIO DE SESI√ìN CON API REAL
            // ============================================================
            document.getElementById('loginButton').addEventListener('click', async () => {
                const loginEmailValue = document.getElementById('loginEmail').value.trim();
                const password = document.getElementById('loginPassword').value;
                
                // Validaci√≥n b√°sica del lado del cliente
                if (!loginEmailValue || !password) {
                    showMessage(loginMessage, 'Por favor, introduce correo y contrase√±a.', 'error');
                    return;
                }
                if (!isValidEmail(loginEmailValue)) {
                    showMessage(loginMessage, 'Por favor, introduce un correo electr√≥nico v√°lido.', 'error');
                    return;
                }

                try {
                    showMessage(loginMessage, 'Iniciando sesi√≥n...', 'success');
                    
                    // Usar la funci√≥n de autenticaci√≥n h√≠brida
                    const result = await loginUser(loginEmailValue, password);
                    
                    // Guardar datos de sesi√≥n
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('userEmail', result.user.email);
                    localStorage.setItem('userName', result.user.name || loginEmailValue.split('@')[0]);
                    localStorage.setItem('authToken', result.token);
                    localStorage.setItem('lastLoginDate', new Date().toISOString());
                    localStorage.setItem('loginMethod', 'login');
                      // Mensaje de √©xito y redirecci√≥n inmediata
                    showMessage(loginMessage, '¬°Inicio de sesi√≥n exitoso! Redirigiendo al dashboard...', 'success');
                    
                    console.log('‚úÖ Login exitoso:', result);
                    console.log('üîÑ Redirigiendo al dashboard...');
                      // Redirigir al dashboard con m√∫ltiples opciones de fallback
                    setTimeout(() => {
                        console.log('üîÑ Redirigiendo al dashboard...');
                        // Usar dashboard.html directamente para mayor compatibilidad
                        window.location.href = 'dashboard.html';
                    }, 1500);
                    
                } catch (error) {
                    console.error('‚ùå Error en login:', error);
                    showMessage(loginMessage, error.message || 'Error al iniciar sesi√≥n. Intenta de nuevo.', 'error');
                }
            });
            // ============================================================
            // L√ìGICA DE REGISTRO
            // ============================================================
            document.getElementById('registerButton').addEventListener('click', async () => {
                const nameElement = document.getElementById('registerName');
                const emailElement = document.getElementById('registerEmail');
                const passwordElement = document.getElementById('registerPassword');
                const confirmPasswordElement = document.getElementById('confirmPassword');
                
                // Debug: verificar que los elementos existen
                console.log('=== DEBUG REGISTRO ===');
                console.log('Elemento nombre:', nameElement);
                console.log('Elemento email:', emailElement);
                console.log('Elemento password:', passwordElement);
                console.log('Elemento confirm:', confirmPasswordElement);
                
                const name = nameElement ? nameElement.value.trim() : '';
                const email = emailElement ? emailElement.value.trim() : '';
                const regPassword = passwordElement ? passwordElement.value : '';
                const confirmPassword = confirmPasswordElement ? confirmPasswordElement.value : '';
                
                console.log('Valores capturados:');
                console.log('- Nombre original:', `"${nameElement ? nameElement.value : 'ELEMENTO NO ENCONTRADO'}"`);
                console.log('- Nombre despu√©s de trim:', `"${name}"`);
                console.log('- Longitud del nombre:', name.length);
                console.log('- Email:', `"${email}"`);
                console.log('- Password presente:', regPassword ? 'S√ç' : 'NO');
                console.log('- Confirm presente:', confirmPassword ? 'S√ç' : 'NO');

                // Validaci√≥n del lado del cliente
                if (!name || !email || !regPassword || !confirmPassword) {
                    console.log('‚ùå Falla en validaci√≥n: campos vac√≠os');
                    showMessage(registerMessage, 'Por favor, completa todos los campos.', 'error');
                    return;
                }
                if (name.length < 2) {
                    console.log('‚ùå Falla en validaci√≥n: nombre muy corto');
                    showMessage(registerMessage, 'El nombre debe tener al menos 2 caracteres.', 'error');
                    return;
                }                if (!window.authAPI.isValidEmail(email)) {
                    console.log('‚ùå Falla en validaci√≥n: email inv√°lido');
                    showMessage(registerMessage, 'Por favor, introduce un correo electr√≥nico v√°lido.', 'error');
                    return;
                }
                if (regPassword.length < 6) {
                    console.log('‚ùå Falla en validaci√≥n: contrase√±a muy corta');
                    showMessage(registerMessage, 'La contrase√±a debe tener al menos 6 caracteres.', 'error');
                    return;
                }
                if (regPassword !== confirmPassword) {
                    console.log('‚ùå Falla en validaci√≥n: contrase√±as no coinciden');
                    showMessage(registerMessage, 'Las contrase√±as no coinciden.', 'error');
                    return;
                }

                try {
                    console.log('‚úÖ Todas las validaciones pasaron, llamando a la API...');
                    showMessage(registerMessage, 'Creando cuenta y enviando c√≥digo de verificaci√≥n...', 'success');
                    
                    // Llamada real al backend para registro con nombre
                    const response = await window.authAPI.registerUser(email, regPassword, name);
                    
                    // Guardar email temporalmente para verificaci√≥n
                    localStorage.setItem('tempUserEmail', email);
                    
                    // Mostrar formulario de verificaci√≥n
                    showMessage(registerMessage, 'C√≥digo enviado a tu email. Revisa tu bandeja de entrada.', 'success');
                    showVerificationForm(email, '------'); // No mostrar c√≥digo real por seguridad
                    
                } catch (error) {
                    console.error('Error en registro:', error);
                    showMessage(registerMessage, error.message || 'Error al crear la cuenta. Int√©ntalo de nuevo.', 'error');
                }
            });            // ============================================================
            // L√ìGICA DE RECUPERACI√ìN DE CONTRASE√ëA
            // ============================================================
              // Variables globales para recuperaci√≥n
            let recoveryEmail = '';
            
            // Paso 1: Solicitar c√≥digo de recuperaci√≥n
            document.getElementById('recoverButton').addEventListener('click', async () => {
                const email = document.getElementById('recoverEmail').value.trim();

                if (!email) {
                    showMessage(recoverMessage, 'Por favor, introduce tu correo electr√≥nico.', 'error');
                    return;
                }
                if (!isValidEmail(email)) {
                    showMessage(recoverMessage, 'Por favor, introduce un correo electr√≥nico v√°lido.', 'error');
                    return;
                }                try {
                    showMessage(recoverMessage, 'Enviando c√≥digo de recuperaci√≥n...', 'success');
                    
                    const result = await window.authAPI.requestPasswordRecovery(email);
                    
                    // Guardar email para el siguiente paso
                    recoveryEmail = email;
                    
                    // Mostrar el paso 2
                    document.getElementById('recoverStep1').classList.add('hidden');
                    document.getElementById('recoverStep2').classList.remove('hidden');
                    document.getElementById('recoverEmailDisplay').textContent = email;
                    
                    showMessage(recoverMessage, '¬°C√≥digo enviado! Revisa tu bandeja de entrada.', 'success');
                    
                    // Si hay c√≥digo de desarrollo, mostrarlo
                    if (result.developmentCode) {
                        showMessage(recoverMessage, `C√≥digo de desarrollo: ${result.developmentCode}`, 'info');
                    }
                    
                } catch (error) {
                    console.error('Error en recuperaci√≥n:', error);
                    showMessage(recoverMessage, error.message || 'Error al enviar c√≥digo. Int√©ntalo de nuevo.', 'error');
                }
            });
            
            // Paso 2: Verificar c√≥digo y actualizar contrase√±a
            document.getElementById('resetPasswordButton').addEventListener('click', async () => {
                const code = document.getElementById('recoveryCode').value.trim();
                const newPassword = document.getElementById('newPassword').value;
                const confirmNewPassword = document.getElementById('confirmNewPassword').value;

                // Validaciones
                if (!code) {
                    showMessage(recoverMessage, 'Por favor, introduce el c√≥digo de 6 d√≠gitos.', 'error');
                    return;
                }
                if (code.length !== 6) {
                    showMessage(recoverMessage, 'El c√≥digo debe tener exactamente 6 d√≠gitos.', 'error');
                    return;
                }
                if (!newPassword) {
                    showMessage(recoverMessage, 'Por favor, introduce la nueva contrase√±a.', 'error');
                    return;
                }
                if (newPassword.length < 6) {
                    showMessage(recoverMessage, 'La contrase√±a debe tener al menos 6 caracteres.', 'error');
                    return;
                }
                if (newPassword !== confirmNewPassword) {
                    showMessage(recoverMessage, 'Las contrase√±as no coinciden.', 'error');
                    return;
                }                try {
                    showMessage(recoverMessage, 'Verificando c√≥digo y actualizando contrase√±a...', 'success');
                    
                    const result = await window.authAPI.resetPassword(recoveryEmail, code, newPassword);
                    
                    showMessage(recoverMessage, '¬°Contrase√±a actualizada exitosamente! Ya puedes iniciar sesi√≥n.', 'success');
                    
                    // Resetear formulario y volver al login despu√©s de un delay
                    setTimeout(() => {
                        // Volver al paso 1
                        document.getElementById('recoverStep2').classList.add('hidden');
                        document.getElementById('recoverStep1').classList.remove('hidden');
                        
                        // Limpiar campos
                        document.getElementById('recoverEmail').value = '';
                        document.getElementById('recoveryCode').value = '';
                        document.getElementById('newPassword').value = '';
                        document.getElementById('confirmNewPassword').value = '';
                        
                        // Volver al formulario de login
                        showForm(loginForm);
                        showMessage(recoverMessage, '', '');
                        
                        recoveryEmail = '';
                    }, 3000);
                    
                } catch (error) {
                    console.error('Error al actualizar contrase√±a:', error);
                    showMessage(recoverMessage, error.message || 'Error al actualizar contrase√±a. Verifica el c√≥digo.', 'error');
                }
            });
            
            // Reenviar c√≥digo de recuperaci√≥n
            document.getElementById('resendRecoveryButton').addEventListener('click', async () => {
                if (!recoveryEmail) {
                    showMessage(recoverMessage, 'Error: No hay email de recuperaci√≥n.', 'error');
                    return;
                }                try {
                    showMessage(recoverMessage, 'Reenviando c√≥digo...', 'success');
                    
                    const result = await window.authAPI.requestPasswordRecovery(recoveryEmail);
                    
                    showMessage(recoverMessage, '¬°C√≥digo reenviado! Revisa tu bandeja de entrada.', 'success');
                    
                    // Si hay c√≥digo de desarrollo, mostrarlo
                    if (result.developmentCode) {
                        showMessage(recoverMessage, `C√≥digo de desarrollo: ${result.developmentCode}`, 'info');
                    }
                    
                } catch (error) {
                    console.error('Error al reenviar c√≥digo:', error);
                    showMessage(recoverMessage, error.message || 'Error al reenviar c√≥digo.', 'error');
                }
            });

            // ============================================================
            // CHAT DEL ASISTENTE IA
            // ============================================================
            const aiAssistantChat = document.getElementById('aiAssistantChat');
            const aiAssistantInput = document.getElementById('aiAssistantInput');
            const sendAiMessageBtn = document.getElementById('sendAiMessage');
            const aiAssistantLoading = document.getElementById('aiAssistantLoading');

            // Historial del chat para mantener contexto
            let chatHistory = [{ 
                role: "model", 
                parts: [{ text: "Hola, soy tu asistente de negocios. ¬øEn qu√© puedo ayudarte hoy?" }] 
            }];

            /**
             * Muestra un mensaje en el chat
             * @param {string} role - 'user' o 'ai'
             * @param {string} text - El texto del mensaje
             */
            function displayChatMessage(role, text) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('chat-message', role === 'user' ? 'user' : 'ai');
                messageDiv.textContent = text;
                aiAssistantChat.appendChild(messageDiv);
                aiAssistantChat.scrollTop = aiAssistantChat.scrollHeight; // Auto-scroll hacia abajo
            }

            /**
             * Env√≠a un mensaje del usuario al asistente IA
             */
            async function sendUserMessage() {
                const prompt = aiAssistantInput.value.trim();
                if (!prompt) return;

                // Mostrar mensaje del usuario
                displayChatMessage('user', prompt);
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                aiAssistantInput.value = ''; // Limpiar input

                // Mostrar indicador de carga
                aiAssistantLoading.classList.remove('hidden');

                try {
                    // Configuraci√≥n para la API de Gemini
                    const payload = { contents: chatHistory };
                    const apiKey = ""; // En un entorno real, esta clave vendr√≠a de variables de entorno
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    const result = await response.json();

                    // Procesar respuesta de la API
                    if (result.candidates && result.candidates.length > 0 &&
                        result.candidates[0].content && result.candidates[0].content.parts &&
                        result.candidates[0].content.parts.length > 0) {
                        const aiText = result.candidates[0].content.parts[0].text;
                        displayChatMessage('ai', aiText);
                        chatHistory.push({ role: "model", parts: [{ text: aiText }] });
                    } else {
                        displayChatMessage('ai', 'Lo siento, no pude obtener una respuesta. Intenta de nuevo.');
                        console.error('Estructura de respuesta inesperada:', result);
                    }
                } catch (error) {
                    displayChatMessage('ai', 'Hubo un error al conectar con el asistente. Por favor, intenta m√°s tarde.');
                    console.error('Error al llamar la API de Gemini:', error);
                } finally {
                    // Ocultar indicador de carga
                    aiAssistantLoading.classList.add('hidden');
                }
            }

            // Event listeners para el chat
            sendAiMessageBtn.addEventListener('click', sendUserMessage);
            aiAssistantInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendUserMessage();
                }
            });

            // ============================================================
            // FUNCIONES AUXILIARES
            // ============================================================
              // ============================================================
            // SISTEMA DE VERIFICACI√ìN POR EMAIL
            // ============================================================
            
            /**
             * Muestra el formulario de verificaci√≥n con el c√≥digo generado
             * @param {string} email - Email del usuario
             * @param {string} code - C√≥digo de verificaci√≥n generado
             */
            function showVerificationForm(email, code) {
                // Ocultar todos los formularios
                document.querySelectorAll('.auth-form').forEach(form => {
                    form.classList.add('hidden');
                });
                
                // Mostrar formulario de verificaci√≥n
                const verificationForm = document.getElementById('verificationForm');
                verificationForm.classList.remove('hidden');
                
                // Mostrar email y c√≥digo de demo
                document.getElementById('verificationEmail').textContent = `üìß ${email}`;
                document.getElementById('demoCode').textContent = code;
                
                // Limpiar campo de entrada
                document.getElementById('verificationCode').value = '';
            }            // Event listener para verificar c√≥digo
            document.getElementById('verifyButton').addEventListener('click', async () => {
                const enteredCode = document.getElementById('verificationCode').value.trim();
                const email = localStorage.getItem('tempUserEmail');
                const verificationMessage = document.getElementById('verificationMessage');

                if (!enteredCode) {
                    showMessage(verificationMessage, 'Por favor, introduce el c√≥digo de verificaci√≥n.', 'error');
                    return;
                }

                if (enteredCode.length !== 6) {
                    showMessage(verificationMessage, 'El c√≥digo debe tener 6 d√≠gitos.', 'error');
                    return;
                }

                try {
                    showMessage(verificationMessage, 'Verificando c√≥digo...', 'success');
                    
                    // Llamada real al backend para verificar c√≥digo
                    const response = await window.authAPI.verifyCode(email, enteredCode);
                    
                    // Guardar datos de autenticaci√≥n
                    window.authAPI.saveAuthData(response.token, email);
                    localStorage.setItem('userName', response.user?.name || email.split('@')[0]);
                    localStorage.setItem('registrationDate', new Date().toISOString());
                    localStorage.setItem('loginMethod', 'register');
                    localStorage.setItem('isVerified', 'true');
                    
                    // Limpiar datos temporales
                    localStorage.removeItem('tempUserEmail');
                      showMessage(verificationMessage, '¬°Registro completado! Redirigiendo al dashboard...', 'success');
                      console.log('‚úÖ Verificaci√≥n exitosa, redirigiendo al dashboard...');
                    
                    setTimeout(() => {
                        console.log('üîÑ Redirigiendo al dashboard...');
                        // Usar dashboard.html directamente para mayor compatibilidad
                        window.location.href = 'dashboard.html';
                    }, 1500);
                    
                } catch (error) {
                    console.error('Error en verificaci√≥n:', error);
                    showMessage(verificationMessage, error.message || 'C√≥digo incorrecto. Verifica el c√≥digo enviado a tu email.', 'error');
                }
            });            // Event listener para reenviar c√≥digo
            document.getElementById('resendCodeButton').addEventListener('click', async () => {
                const email = localStorage.getItem('tempUserEmail');
                const verificationMessage = document.getElementById('verificationMessage');
                
                if (!email) {
                    showMessage(verificationMessage, 'Error: No se encontr√≥ email para reenv√≠o.', 'error');
                    return;
                }
                
                try {
                    showMessage(verificationMessage, 'Reenviando c√≥digo...', 'success');
                    
                    // Llamada real al backend para reenviar c√≥digo
                    await window.authAPI.resendCode(email);
                    
                    showMessage(verificationMessage, '¬°Nuevo c√≥digo enviado! Revisa tu email.', 'success');
                    setTimeout(() => verificationMessage.classList.add('hidden'), 3000);
                    
                } catch (error) {
                    console.error('Error al reenviar c√≥digo:', error);
                    showMessage(verificationMessage, error.message || 'Error al reenviar c√≥digo. Int√©ntalo de nuevo.', 'error');
                }
            });

            /**
             * Guarda un nuevo usuario en la base de datos de clientes
             * @param {string} email - Email del usuario
             * @param {string} name - Nombre del usuario
             */
            function saveUserToDatabase(email, name) {
                // Obtener usuarios existentes
                let users = JSON.parse(localStorage.getItem('malinoise_users') || '[]');
                
                // Crear nuevo usuario
                const newUser = {
                    id: generateUserId(),
                    email: email,
                    name: name,
                    registrationDate: new Date().toISOString(),
                    isVerified: true,
                    role: 'user',
                    status: 'active',
                    lastLogin: new Date().toISOString(),
                    totalSales: 0,
                    productsCount: 0
                };
                
                // A√±adir usuario si no existe
                if (!users.find(user => user.email === email)) {
                    users.push(newUser);
                    localStorage.setItem('malinoise_users', JSON.stringify(users));
                    console.log('Usuario guardado en base de datos:', newUser);
                }
            }

            /**
             * Genera un ID √∫nico para el usuario
             * @returns {string} ID √∫nico
             */
            function generateUserId() {
                return 'USR_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }

            // ============================================================
            // FUNCIONES AUXILIARES
            // ============================================================
            
            /**
             * Valida si un email tiene formato correcto
             * @param {string} email - El email a validar
             * @returns {boolean} - True si es v√°lido, false si no
             */
            function isValidEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            /**
             * Muestra un mensaje de feedback en los formularios
             * @param {HTMLElement} messageElement - El elemento donde mostrar el mensaje
             * @param {string} text - El texto del mensaje
             * @param {string} type - 'success' o 'error'
             */
            function showMessage(messageElement, text, type) {
                messageElement.textContent = text;
                messageElement.className = `form-message ${type}`;
                messageElement.classList.remove('hidden');
            }
        });
    </script>    <!-- Script principal simple para desarrollo -->
    <script src="/js/app-simple.js"></script>
    
    <!-- Script espec√≠fico para la p√°gina principal -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar selectores de divisas en m√≥vil tambi√©n
            const currencyMobile = document.getElementById('currency-selector-mobile');
            if (currencyMobile && window.currencySystem) {
                const mobileSelector = window.currencySystem.createCurrencySelector();
                mobileSelector.className = 'bg-white border border-slate-300 rounded px-2 py-1 text-xs';
                currencyMobile.appendChild(mobileSelector);
            }

            // Funciones espec√≠ficas para la autenticaci√≥n con la nueva API
            window.handleRegister = async function(email, password, name) {
                try {
                    const result = await window.auth.register(email, password, name);
                    if (result.success) {
                        // Mostrar formulario de verificaci√≥n
                        document.getElementById('auth-register').classList.add('hidden');
                        document.getElementById('auth-verify').classList.remove('hidden');
                        
                        // Guardar email para la verificaci√≥n
                        document.getElementById('verify-email').value = email;
                        
                        return true;
                    }
                } catch (error) {
                    console.error('Error en registro:', error);
                    return false;
                }
            };

            window.handleVerifyCode = async function(email, code) {
                try {
                    const result = await window.auth.verifyCode(email, code);
                    if (result.success) {
                        // Redirigir al dashboard
                        window.location.href = '/dashboard';
                        return true;
                    }
                } catch (error) {
                    console.error('Error en verificaci√≥n:', error);
                    return false;
                }
            };

            window.handleLogin = async function(email, password) {
                try {
                    const result = await window.auth.login(email, password);
                    if (result.success) {
                        // Redirigir al dashboard
                        window.location.href = '/dashboard';
                        return true;
                    }
                } catch (error) {
                    console.error('Error en login:', error);
                    return false;
                }
            };

            window.handleResendCode = async function() {
                const email = document.getElementById('verify-email').value;
                if (email) {
                    try {
                        await window.auth.resendCode(email);
                        return true;
                    } catch (error) {
                        console.error('Error reenviando c√≥digo:', error);
                        return false;
                    }
                }
            };

            // Funci√≥n para descargar PDFs desde la interfaz
            window.downloadHistorial = function() {
                if (window.auth.isAuthenticated()) {
                    window.pdfSystem.downloadTransactionHistory();
                } else {
                    window.notifications.warning('Debes iniciar sesi√≥n para descargar tu historial');
                    document.getElementById('auth').scrollIntoView({ behavior: 'smooth' });
                }
            };

            // Agregar botones de descarga de PDF a la secci√≥n de descargas si el usuario est√° autenticado
            function updateDownloadOptions() {
                if (window.auth.isAuthenticated()) {
                    const downloadSection = document.querySelector('#downloads .grid');
                    if (downloadSection && !document.getElementById('pdf-download-card')) {
                        const pdfCard = document.createElement('div');
                        pdfCard.id = 'pdf-download-card';
                        pdfCard.className = 'download-card bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition-all relative overflow-hidden';
                        pdfCard.innerHTML = `
                            <div class="flex items-center justify-between mb-4">
                                <i class="fas fa-file-pdf text-4xl text-red-500"></i>
                                <span class="text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full">Reportes</span>
                            </div>
                            <h3 class="font-semibold text-slate-800 mb-2">Descargar Historial</h3>
                            <p class="text-sm text-slate-600 mb-4">Obt√©n tu historial de transacciones en PDF</p>
                            <button onclick="downloadHistorial()" class="w-full bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition-colors">
                                <i class="fas fa-download mr-2"></i>Descargar PDF
                            </button>
                        `;
                        downloadSection.appendChild(pdfCard);
                    }
                }
            }

            // Actualizar opciones cuando cambie el estado de autenticaci√≥n
            if (window.auth.isAuthenticated()) {
                updateDownloadOptions();
            }
        });
    </script>
</body>
</html>
